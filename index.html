<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AS/400 - Système de Comptabilité</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Écran d'authentification -->
    <div id="auth-screen" class="screen active">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>
        
        <div class="connect-dialog">
            <div class="dialog-header">
                <span>Authentification</span>
                <button class="close-btn">×</button>
            </div>
            <div class="dialog-content">
                <label>Email:</label>
                <input type="text" id="auth-email" class="field-input" placeholder="votre@email.com">
                <label>Mot de passe:</label>
                <input type="password" id="auth-password" class="field-input" placeholder="********">
                <div class="dialog-buttons">
                    <button id="auth-signup" class="btn">S'inscrire</button>
                    <button id="auth-signin" class="btn">Se connecter</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Écran d'ouverture système -->
    <div id="system-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>
        
        <div class="terminal-content">
            <div class="system-info">
                <div class="center">Ouverture</div>
                <br>
                <div class="right">Système . . . . . . . : S061F745</div>
                <div class="right">Sous-système . . . : QINTER</div>
                <div class="right">Écran . . . . . . . : QPADEV037K</div>
                <br><br>
                <div>Utilisateur . . . . . . . . . .</div>
                <div>Mot de passe . . . . . . . . .</div>
                <div>Programme/procédure . . . . .</div>
                <div>Menu . . . . . . . . . . . . .</div>
                <div>Bibliothèque en cours . . . .</div>
            </div>
            
        </div>
    </div>

    <!-- Écran choix société -->
    <div id="company-screen" class="screen">
        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div>Indiquez vos choix, puis appuyez sur Entr{e.</div>
            <div>1=Choisir</div>
            <br>
            <div id="company-list-container" class="company-list">
                <!-- La liste des sociétés sera chargée ici par JavaScript -->
            </div>
            <div class="right">A suivre...</div>

            <div class="add-company-form">
                <input type="text" id="new-company-name" placeholder="Nom de la nouvelle société">
                <button id="add-company-btn">Ajouter Société</button>
            </div>
            <div class="footer-container">
            </div>
        </div>
    </div>

    <!-- Menu général -->
    <div id="main-menu-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>
        
        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div>Choisissez l'une des options suivantes :</div>
            <br><br>
            <div class="menu-options">
                <div><span class="menu-number">1.</span>    Menu comptabilité</div>
                <div><span class="menu-number">2.</span>    Menu Sécurité</div>
                <div><span class="menu-number">3.</span>    Choix d'une société de travail</div>
                <div><span class="menu-number">4.</span>    Fin de session</div>
            </div>
            <br><br><br><br><br><br><br><br><br><br>
            <div class="right">Fin</div>
            <div class="footer-container">
                <div class="input-prompt">
                    <span>===>&nbsp;<input type="text" id="main-menu-input" class="command-input" maxlength="10"></span>
                    <span>Option ou commande</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Menu comptabilité -->
    <div id="accounting-menu-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>
        
        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div>Choisissez l'une des options suivantes :</div>
            <br><br>
            <div class="menu-options">
                <div><span class="menu-number">1.</span>    Comptes</div>
                <div><span class="menu-number">2.</span>    Journaux</div>
                <div><span class="menu-number">3.</span>    Écritures</div>
                <div><span class="menu-number">4.</span>    Éditions</div>
                <div><span class="menu-number">5.</span>    Paramètres</div>
                <div><span class="menu-number">6.</span>    Traitements fin exercice</div>
                <div><span class="menu-number">7.</span>    Tableau de bord</div>
            </div>
            <br><br><br><br><br><br><br><br><br>
            <div class="right">Fin</div>
            <div class="footer-container">
                <div class="input-prompt">
                    <span>===>&nbsp;<input type="text" id="accounting-menu-input" class="command-input" maxlength="10"></span>
                    <span>Option ou commande</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Écran écritures -->
    <div id="entries-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>
        
        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div>Choisissez l'une des options suivantes :</div>
            <br><br>
            <div class="menu-options">
                <div><span class="menu-number">1.</span>    Gestion des Brouillards</div>
                <div><span class="menu-number">2.</span>    Paramétrage des masques</div>
                <div><span class="menu-number">3.</span>    Saisie d'écriture directe</div>
                <div><span class="menu-number">4.</span>    Liste des lots d'écritures</div>
                <div><span class="menu-number">5.</span>    Gestion des Brouillards Automatiques</div>
                <div><span class="menu-number">6.</span>    Intégration des interfaces BIG immédiatement</div>
                <div><span class="menu-number">7.</span>    Intégration des interfaces SPS immédiatement</div>
                <div><span class="menu-number">8.</span>    Intégration des interfaces MBS immédiatement</div>
                <div><span class="menu-number">9.</span>    Intégration des interfaces ABB immédiatement</div>
                <div><span class="menu-number">10.</span>   Intégration des interfaces DOU immédiatement</div>
                <div><span class="menu-number">11.</span>   Intégration des interfaces NAT immédiatement</div>
                <div><span class="menu-number">12.</span>   Intégration des factures achat BIG immédiatement</div>
                <div><span class="menu-number">13.</span>   Intégration immédiate des traites fournisseurs BIG</div>
                <div><span class="menu-number">14.</span>   Intégration immédiate des factures d'achat ABB</div>
            </div>
            <div class="right">A suivre...</div>
            <div class="footer-container">
                <div class="input-prompt">
                    <span>===>&nbsp;<input type="text" id="entries-menu-input" class="command-input" maxlength="10"></span>
                    <span>Option ou commande</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Écran saisie écriture -->
    <div id="entry-input-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>
        
        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            
            <br>
            <div>Indiquez vos choix, puis appuyez sur Entrée.</div>
            <br>
            <div class="form-fields">
                
                <div>Date comptable . . . . . . . <input type="text" id="date-comptable" class="field-input" placeholder="JJ/MM/AAAA" maxlength="10">    JJ/MM/AAAA</div>
                <br>
                <div>Code journal . . . . . . . . <input type="text" id="journal-code-input" class="field-input" maxlength="10"></div>
                <br>
                <div id="journal-selection-list" style="margin-top: 10px; padding: 10px; border: 1px solid #00ff00; height: 100px; overflow-y: auto;">
                    <!-- La liste des journaux disponibles sera chargée ici -->
                </div>
                <br>
                
                
                <br>
                
            </div>
            <div class="status-bar">
            </div>
        </div>
    </div>

    <!-- Écran saisie écriture sans masque -->
    <div id="entry-detail-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>
        
        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div id="current-journal-display" style="text-align: center; color: #ffff00; font-weight: bold;"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>

            <!-- Section des champs obligatoires -->
            <div class="mandatory-fields">
                <div style="color: #ffff00; font-weight: bold; margin-bottom: 10px;">▼ SAISIE ÉCRITURE ▼</div>
                <div class="form-row">
                    <span>Compte </span><input type="text" id="mf-compte" class="field-8" placeholder="Requis">
                    <span style="margin-left: 20px;">S </span><input type="text" id="mf-s" class="field-1" maxlength="1">
                    <span style="margin-left: 20px;">Montant </span><input type="text" id="mf-montant" class="field-15" placeholder="0,00">
                </div>
                <br>
                <div class="form-row">
                    <span>Libellé </span><input type="text" id="mf-libelle" class="field-30" placeholder="Description de l&apos;écriture">
                    <span style="margin-left: 20px;">Date </span><input type="text" id="mf-date" class="field-8" placeholder="JJ/MM/AA">
                    <button id="add-entry-line-btn" class="btn" style="margin-left: 15px;">Ajouter Ligne</button>
                </div>
            </div>

            

            <!-- Tableau des comptes -->
            <div class="accounts-table" style="margin-top: 15px; height: 120px; overflow-y: auto; border-bottom: 1px solid #00ff00; padding-top: 5px;">
                <div class="table-content" style="margin-top: 10px;">
                    <span class="no-data">(Aucun élément à afficher)</span>
                </div>
            </div>
            
            <!-- Totaux -->
            <div class="totals-line" style="margin-top: 5px;">
                <span>                                        Solde              Totaux</span>
            </div>
            
            <!-- Bouton de validation du lot -->
            <div style="text-align: center; margin-top: 20px;">
                <button id="validate-batch-btn" class="btn">Valider le Lot</button>
            </div>
            
            

            <!-- Message imprimante -->
            
            
            <div class="status-bar">
            </div>
        </div>
    </div>

    <!-- Account Lookup Modal -->
    <div id="account-lookup-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3>Sélectionner un Compte</h3>
            <div id="account-lookup-list" class="table-content" style="max-height: 200px; overflow-y: auto;"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-client.js"></script>
    <script src="app.js"></script>
</body>
    <!-- Écran Comptes -->
    <div id="accounts-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>
        
        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div style="margin-bottom: 10px;">
                <button id="export-accounts-btn" class="btn">Exporter le Plan Comptable (CSV)</button>
            </div>
            <div class="accounts-list">
                <div class="table-header">
                    <span style="display: inline-block; width: 10ch;">Numéro</span>
                    <span style="display: inline-block; width: 30ch;">Libellé</span>
                    <span style="display: inline-block; width: 20ch;">Actions</span>
                </div>
                <div class="table-content" id="accounts-table-content" style="height: 200px; overflow-y: auto;">
                    <span class="no-data">(Chargement des comptes...)</span>
                </div>
            </div>
            <div class="add-account-form" style="margin-top: 20px;">
                <input type="text" id="new-account-number" placeholder="Numéro (ex: 600000)" maxlength="10" style="width: 15ch;">
                <input type="text" id="new-account-label" placeholder="Libellé du nouveau compte" style="width: 30ch;">
                <button id="add-account-btn" class="btn" data-mode="add">Ajouter</button>
            </div>
            <div class="footer-container">
                <div class="status-bar"></div>
                <div class="input-prompt">
                    <span>===>&nbsp;<input type="text" id="accounts-command-input" class="command-input" maxlength="10"></span>
                    <span>Option ou commande</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Écran Détail Compte -->
    <div id="account-detail-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>
        
        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div class="account-entries-list">
                <div class="filter-section" style="margin-bottom: 10px;">
                    <span>Afficher à partir du: </span>
                    <input type="date" id="account-start-date" class="field-input">
                    <span class="sort-buttons" style="margin-left: 20px;">
                        <span>Trier par:</span>
                        <button id="account-sort-desc" class="btn-sort active">↓ Récent</button>
                        <button id="account-sort-asc" class="btn-sort">↑ Ancien</button>
                    </span>
                    <button id="print-account-btn" class="btn" style="margin-left: 20px;">Imprimer</button>
                    <button id="export-account-btn" class="btn" style="margin-left: 10px;">Exporter CSV</button>
                </div>
            <div class="table-content" id="account-entries-table-content">
                <span class="no-data">(Chargement des écritures...)</span>
            </div>
            </div>

            <div style="border-top: 1px solid #00FF00; margin-top: 10px; padding-top: 5px;"></div>

            <!-- Totaux -->
            <div class="totals-line" style="margin-top: 5px;">
                <span>                                        Solde              Totaux</span>
            </div>
            <div class="footer-container">
                <div class="status-bar"></div>
            </div>
        </div>
    </div>

    <!-- Écran Détail Journal -->
    <div id="journal-detail-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>
        
        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div class="journal-entries-list">
                <div class="filter-section" style="margin-bottom: 10px;">
                    <span>Afficher à partir du: </span>
                    <input type="date" id="journal-start-date" class="field-input">
                    <span class="sort-buttons" style="margin-left: 20px;">
                        <span>Trier par:</span>
                        <button id="journal-sort-desc" class="btn-sort active">↓ Récent</button>
                        <button id="journal-sort-asc" class="btn-sort">↑ Ancien</button>
                    </span>
                    <button id="print-journal-btn" class="btn" style="margin-left: 20px;">Imprimer</button>
                    <button id="export-journal-btn" class="btn" style="margin-left: 10px;">Exporter CSV</button>
                </div>
                <div class="table-content" id="journal-entries-table-content" style="height: 300px; overflow-y: auto;">
                    <span class="no-data">(Chargement des écritures...)</span>
                </div>
            </div>

            <div style="border-top: 1px solid #00FF00; margin-top: 10px; padding-top: 5px;"></div>

            <!-- Totaux -->
            <div class="totals-line" style="margin-top: 5px;">
                <span>                                        Solde              Totaux</span>
            </div>
            <div class="footer-container">
                <div class="status-bar"></div>
            </div>
        </div>
    </div>

    <!-- Écran Journaux -->
    <div id="journals-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>

        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div class="journals-list">
                <div class="table-header">
                    <span style="display: inline-block; width: 10ch;">Code</span>
                    <span style="display: inline-block; width: 30ch;">Nom du Journal</span>
                    <span style="display: inline-block; width: 20ch;">Actions</span>
                </div>
                <div class="table-content" id="journals-table-content" style="height: 200px; overflow-y: auto;">
                    <span class="no-data">(Chargement des journaux...)</span>
                </div>
            </div>
            <div class="add-journal-form" style="margin-top: 20px;">
                <input type="text" id="new-journal-code" placeholder="Code (ex: AC)" maxlength="4" style="width: 8ch;">
                <input type="text" id="new-journal-name" placeholder="Nom du nouveau journal" style="width: 30ch;">
                <button id="add-journal-btn" class="btn" data-mode="add">Ajouter</button>
            </div>
            <div class="footer-container">
                <div class="status-bar"></div>
                <div class="input-prompt">
                    <span>===>&nbsp;<input type="text" id="journals-command-input" class="command-input" maxlength="10"></span>
                    <span>Option ou commande</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Écran Rapports -->
    <div id="reports-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>

        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div>Rapports Comptables</div>
            <br>

            <!-- Sélection du type de rapport -->
            <div style="margin-bottom: 15px;">
                <span>Type de rapport: </span>
                <select id="report-type" class="field-input" style="width: 30ch; background-color: #333; color: #FFFFFF; border: 1px solid #00FF00; padding: 5px;">
                    <option value="">-- Sélectionnez un rapport --</option>
                    <option value="balance">Balance des comptes</option>
                    <option value="ledger">Grand livre</option>
                    <option value="centralized">Journal centralisateur</option>
                </select>
            </div>

            <!-- Filtres de période -->
            <div class="filter-section" style="margin-bottom: 15px;">
                <span>Période du: </span>
                <input type="date" id="report-start-date" class="field-input" style="width: 15ch;">
                <span style="margin-left: 20px;">au: </span>
                <input type="date" id="report-end-date" class="field-input" style="width: 15ch;">
                <button id="generate-report-btn" class="btn" style="margin-left: 20px;">Générer le rapport</button>
            </div>

            <!-- Filtre supplémentaire pour le grand livre -->
            <div id="ledger-account-filter" style="margin-bottom: 15px; display: none;">
                <span>Compte (optionnel): </span>
                <input type="text" id="ledger-account-number" class="field-input" placeholder="Numéro de compte" style="width: 15ch;">
                <span style="margin-left: 10px; color: #FFFF00; font-size: 0.9em;">(Laissez vide pour tous les comptes)</span>
            </div>

            <!-- Boutons d'action -->
            <div style="margin-bottom: 15px;">
                <button id="export-report-btn" class="btn" style="display: none;">Exporter CSV</button>
                <button id="print-report-btn" class="btn" style="margin-left: 10px; display: none;">Imprimer</button>
            </div>

            <!-- Zone d'affichage du rapport -->
            <div id="report-content" style="border: 1px solid #00FF00; padding: 10px; min-height: 300px; max-height: 400px; overflow-y: auto;">
                <span class="no-data">Sélectionnez un type de rapport et cliquez sur "Générer le rapport"</span>
            </div>

            <div class="footer-container">
                <div class="status-bar"></div>
            </div>
        </div>
    </div>

    <!-- Écran Paramètres -->
    <div id="settings-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>

        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div style="font-weight: bold; color: #FFFF00;">PARAMÈTRES DE LA COMPTABILITÉ</div>
            <br>

            <!-- Paramètres de l'exercice comptable -->
            <div style="border: 1px solid #00FF00; padding: 15px; margin-bottom: 20px;">
                <div style="font-weight: bold; margin-bottom: 10px;">Exercice Comptable</div>
                <div style="margin-bottom: 10px;">
                    <span style="display: inline-block; width: 25ch;">Date de début d'exercice :</span>
                    <input type="date" id="setting-year-start" class="field-input" style="width: 15ch;">
                </div>
                <div style="margin-bottom: 10px;">
                    <span style="display: inline-block; width: 25ch;">Date de fin d'exercice :</span>
                    <input type="date" id="setting-year-end" class="field-input" style="width: 15ch;">
                </div>
                <div style="margin-bottom: 10px;">
                    <span style="display: inline-block; width: 25ch;">Exercice clôturé :</span>
                    <input type="checkbox" id="setting-year-closed" disabled>
                    <span id="setting-year-status" style="margin-left: 10px; color: #FFFF00;"></span>
                </div>
                <button id="save-year-settings-btn" class="btn">Enregistrer les dates d'exercice</button>
            </div>

            <!-- Informations du club -->
            <div style="border: 1px solid #00FF00; padding: 15px; margin-bottom: 20px;">
                <div style="font-weight: bold; margin-bottom: 10px;">Informations du Club</div>
                <div style="margin-bottom: 10px;">
                    <span style="display: inline-block; width: 25ch;">Nom du club :</span>
                    <input type="text" id="setting-club-name" class="field-input" style="width: 40ch;">
                </div>
                <div style="margin-bottom: 10px;">
                    <span style="display: inline-block; width: 25ch;">Adresse :</span>
                    <input type="text" id="setting-club-address" class="field-input" style="width: 40ch;">
                </div>
                <div style="margin-bottom: 10px;">
                    <span style="display: inline-block; width: 25ch;">Code postal :</span>
                    <input type="text" id="setting-club-zipcode" class="field-input" style="width: 10ch;">
                    <span style="margin-left: 10px;">Ville :</span>
                    <input type="text" id="setting-club-city" class="field-input" style="width: 25ch;">
                </div>
                <div style="margin-bottom: 10px;">
                    <span style="display: inline-block; width: 25ch;">Téléphone :</span>
                    <input type="text" id="setting-club-phone" class="field-input" style="width: 20ch;">
                </div>
                <div style="margin-bottom: 10px;">
                    <span style="display: inline-block; width: 25ch;">Email :</span>
                    <input type="email" id="setting-club-email" class="field-input" style="width: 40ch;">
                </div>
                <button id="save-club-settings-btn" class="btn">Enregistrer les informations</button>
            </div>

            <!-- Comptes par défaut -->
            <div style="border: 1px solid #00FF00; padding: 15px;">
                <div style="font-weight: bold; margin-bottom: 10px;">Comptes par Défaut</div>
                <div style="margin-bottom: 10px;">
                    <span style="display: inline-block; width: 25ch;">Compte banque :</span>
                    <input type="text" id="setting-default-bank" class="field-input" style="width: 10ch;" placeholder="512000">
                </div>
                <div style="margin-bottom: 10px;">
                    <span style="display: inline-block; width: 25ch;">Compte caisse :</span>
                    <input type="text" id="setting-default-cash" class="field-input" style="width: 10ch;" placeholder="530000">
                </div>
                <div style="margin-bottom: 10px;">
                    <span style="display: inline-block; width: 25ch;">Compte résultat :</span>
                    <input type="text" id="setting-default-result" class="field-input" style="width: 10ch;" placeholder="120000">
                </div>
                <button id="save-default-accounts-btn" class="btn">Enregistrer les comptes</button>
            </div>

            <div class="footer-container">
                <div class="status-bar"></div>
            </div>
        </div>
    </div>

    <!-- Écran Traitements Fin d'Exercice -->
    <div id="year-end-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>

        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div style="font-weight: bold; color: #FFFF00;">TRAITEMENTS FIN D'EXERCICE</div>
            <br>

            <!-- Informations sur l'exercice -->
            <div id="year-end-info" style="border: 1px solid #00FF00; padding: 15px; margin-bottom: 20px;">
                <div style="font-weight: bold; margin-bottom: 10px;">Informations sur l'exercice en cours</div>
                <div style="margin-bottom: 5px;">
                    <span style="display: inline-block; width: 30ch;">Période :</span>
                    <span id="current-year-period" style="color: #FFFF00;"></span>
                </div>
                <div style="margin-bottom: 5px;">
                    <span style="display: inline-block; width: 30ch;">Statut :</span>
                    <span id="current-year-status-display" style="color: #FFFF00;"></span>
                </div>
                <div style="margin-bottom: 5px;">
                    <span style="display: inline-block; width: 30ch;">Nombre d'écritures :</span>
                    <span id="current-year-entries-count" style="color: #FFFF00;"></span>
                </div>
                <div style="margin-bottom: 5px;">
                    <span style="display: inline-block; width: 30ch;">Résultat de l'exercice :</span>
                    <span id="current-year-result" style="color: #FFFF00;"></span>
                </div>
            </div>

            <!-- Avertissement -->
            <div style="border: 1px solid #FFFF00; padding: 15px; margin-bottom: 20px; background-color: #222;">
                <div style="color: #FFFF00; font-weight: bold; margin-bottom: 10px;">⚠️ ATTENTION</div>
                <div style="color: #FFFF00;">
                    La clôture de l'exercice est une opération définitive qui :
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li>Verrouille toutes les écritures de l'exercice</li>
                        <li>Calcule le résultat de l'exercice</li>
                        <li>Génère les écritures de report à nouveau</li>
                        <li>Crée le nouvel exercice comptable</li>
                    </ul>
                    Cette opération ne peut pas être annulée facilement.
                </div>
            </div>

            <!-- Actions -->
            <div style="border: 1px solid #00FF00; padding: 15px;">
                <div style="font-weight: bold; margin-bottom: 15px;">Actions disponibles</div>

                <div style="margin-bottom: 20px;">
                    <button id="calculate-result-btn" class="btn" style="min-width: 40ch;">1. Calculer le résultat de l'exercice</button>
                    <div style="margin-top: 5px; color: #888; font-size: 0.9em;">Calcule le résultat sans modifier les écritures</div>
                </div>

                <div style="margin-bottom: 20px;">
                    <button id="generate-closing-entries-btn" class="btn" style="min-width: 40ch;">2. Générer les écritures de clôture</button>
                    <div style="margin-top: 5px; color: #888; font-size: 0.9em;">Crée les écritures de transfert au compte résultat</div>
                </div>

                <div style="margin-bottom: 20px;">
                    <button id="close-year-btn" class="btn" style="min-width: 40ch; background-color: #661100; border-color: #FF0000;">3. Clôturer définitivement l'exercice</button>
                    <div style="margin-top: 5px; color: #FF0000; font-size: 0.9em;">⚠️ Opération irréversible - Verrouille l'exercice et crée le report à nouveau</div>
                </div>
            </div>

            <div class="footer-container">
                <div class="status-bar"></div>
            </div>
        </div>
    </div>

    <!-- Écran Tableau de Bord -->
    <div id="dashboard-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>

        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div style="font-weight: bold; color: #FFFF00; font-size: 1.2em;">📊 TABLEAU DE BORD</div>
            <br>

            <!-- Alertes -->
            <div id="dashboard-alerts" style="margin-bottom: 20px;"></div>

            <!-- Vue d'ensemble financière -->
            <div style="border: 1px solid #00FF00; padding: 15px; margin-bottom: 20px;">
                <div style="font-weight: bold; margin-bottom: 15px; color: #00FF00;">💰 VUE D'ENSEMBLE FINANCIÈRE</div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <div style="margin-bottom: 10px;">
                            <span style="display: inline-block; width: 25ch; color: #888;">Trésorerie (Banque + Caisse) :</span>
                            <span id="dashboard-tresorerie" style="font-weight: bold; color: #FFFF00;">0.00 €</span>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <span style="display: inline-block; width: 25ch; color: #888;">Résultat de l'exercice :</span>
                            <span id="dashboard-resultat" style="font-weight: bold; color: #FFFF00;">0.00 €</span>
                        </div>
                    </div>
                    <div>
                        <div style="margin-bottom: 10px;">
                            <span style="display: inline-block; width: 25ch; color: #888;">Total Produits (7xxxxx) :</span>
                            <span id="dashboard-produits" style="font-weight: bold; color: #00FF00;">0.00 €</span>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <span style="display: inline-block; width: 25ch; color: #888;">Total Charges (6xxxxx) :</span>
                            <span id="dashboard-charges" style="font-weight: bold; color: #FF6666;">0.00 €</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Indicateurs d'activité -->
            <div style="border: 1px solid #00FF00; padding: 15px; margin-bottom: 20px;">
                <div style="font-weight: bold; margin-bottom: 15px; color: #00FF00;">📈 INDICATEURS D'ACTIVITÉ</div>

                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 10px; text-align: center;">
                    <div style="border: 1px solid #666; padding: 10px;">
                        <div style="color: #888; font-size: 0.9em; margin-bottom: 5px;">Écritures ce mois</div>
                        <div id="dashboard-entries-month" style="font-size: 1.5em; font-weight: bold; color: #FFFF00;">0</div>
                    </div>
                    <div style="border: 1px solid #666; padding: 10px;">
                        <div style="color: #888; font-size: 0.9em; margin-bottom: 5px;">Écritures exercice</div>
                        <div id="dashboard-entries-year" style="font-size: 1.5em; font-weight: bold; color: #FFFF00;">0</div>
                    </div>
                    <div style="border: 1px solid #666; padding: 10px;">
                        <div style="color: #888; font-size: 0.9em; margin-bottom: 5px;">Comptes actifs</div>
                        <div id="dashboard-accounts-count" style="font-size: 1.5em; font-weight: bold; color: #FFFF00;">0</div>
                    </div>
                    <div style="border: 1px solid #666; padding: 10px;">
                        <div style="color: #888; font-size: 0.9em; margin-bottom: 5px;">Journaux actifs</div>
                        <div id="dashboard-journals-count" style="font-size: 1.5em; font-weight: bold; color: #FFFF00;">0</div>
                    </div>
                </div>
            </div>

            <!-- Informations sur l'exercice -->
            <div style="border: 1px solid #00FF00; padding: 15px; margin-bottom: 20px;">
                <div style="font-weight: bold; margin-bottom: 15px; color: #00FF00;">📅 EXERCICE COMPTABLE</div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <div style="margin-bottom: 10px;">
                            <span style="display: inline-block; width: 20ch; color: #888;">Période :</span>
                            <span id="dashboard-year-period" style="color: #FFFF00;">Non défini</span>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <span style="display: inline-block; width: 20ch; color: #888;">Statut :</span>
                            <span id="dashboard-year-status" style="color: #00FF00;">OUVERT</span>
                        </div>
                    </div>
                    <div>
                        <div style="margin-bottom: 10px;">
                            <span style="display: inline-block; width: 20ch; color: #888;">Jours restants :</span>
                            <span id="dashboard-year-days-left" style="color: #FFFF00;">-</span>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <span style="display: inline-block; width: 20ch; color: #888;">Avancement :</span>
                            <span id="dashboard-year-progress" style="color: #FFFF00;">-</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Top comptes -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <!-- Top charges -->
                <div style="border: 1px solid #FF6666; padding: 15px;">
                    <div style="font-weight: bold; margin-bottom: 15px; color: #FF6666;">📉 TOP 5 CHARGES</div>
                    <div id="dashboard-top-charges" style="font-family: 'Courier New', monospace; font-size: 0.9em;">
                        <div style="color: #888;">Chargement...</div>
                    </div>
                </div>

                <!-- Top produits -->
                <div style="border: 1px solid #00FF00; padding: 15px;">
                    <div style="font-weight: bold; margin-bottom: 15px; color: #00FF00;">📈 TOP 5 PRODUITS</div>
                    <div id="dashboard-top-produits" style="font-family: 'Courier New', monospace; font-size: 0.9em;">
                        <div style="color: #888;">Chargement...</div>
                    </div>
                </div>
            </div>

            <!-- Évolution mensuelle -->
            <div style="border: 1px solid #00FF00; padding: 15px; margin-bottom: 20px;">
                <div style="font-weight: bold; margin-bottom: 15px; color: #00FF00;">📊 ÉVOLUTION MENSUELLE (6 derniers mois)</div>
                <div id="dashboard-monthly-chart" style="font-family: 'Courier New', monospace; font-size: 0.85em; overflow-x: auto;">
                    <div style="color: #888;">Chargement...</div>
                </div>
            </div>

            <!-- Boutons d'action rapide -->
            <div style="border: 1px solid #FFFF00; padding: 15px;">
                <div style="font-weight: bold; margin-bottom: 15px; color: #FFFF00;">⚡ ACTIONS RAPIDES</div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button id="dashboard-refresh-btn" class="btn">🔄 Actualiser</button>
                    <button id="dashboard-goto-entries-btn" class="btn">📝 Saisir une écriture</button>
                    <button id="dashboard-goto-reports-btn" class="btn">📄 Générer un rapport</button>
                    <button id="dashboard-goto-settings-btn" class="btn">⚙️ Paramètres</button>
                </div>
            </div>

            <div class="footer-container">
                <div class="status-bar"></div>
            </div>
        </div>
    </div>

    <!-- Écran Liste des Lots -->
    <div id="batches-screen" class="screen">
        <div class="toolbar">
            <button class="toolbar-btn">About</button>
            <button class="toolbar-btn">Help</button>
        </div>

        <div class="terminal-content">
            <div class="header-new">
                <div class="breadcrumb"></div>
                <div class="datetime">
                    <span class="date"></span>
                    <span class="time"></span>
                </div>
            </div>
            <br>
            <div>Liste des lots d'écritures</div>
            <br>

            <!-- Filtres -->
            <div class="filter-section" style="margin-bottom: 15px;">
                <span>Journal: </span>
                <select id="batch-filter-journal" class="field-input" style="width: 20ch; background-color: #333; color: #FFFFFF; border: 1px solid #00FF00; padding: 5px;">
                    <option value="">Tous les journaux</option>
                </select>
                <span style="margin-left: 20px;">Date min: </span>
                <input type="date" id="batch-filter-start-date" class="field-input" style="width: 15ch;">
                <span style="margin-left: 20px;">Date max: </span>
                <input type="date" id="batch-filter-end-date" class="field-input" style="width: 15ch;">
                <button id="batch-filter-btn" class="btn" style="margin-left: 15px;">Filtrer</button>
                <button id="batch-reset-filter-btn" class="btn" style="margin-left: 10px;">Réinitialiser</button>
                <button id="export-batches-btn" class="btn" style="margin-left: 10px;">Exporter CSV</button>
            </div>

            <!-- Liste des lots -->
            <div class="batches-list">
                <div class="table-header">
                    <span style="display: inline-block; width: 5ch;">N°</span>
                    <span style="display: inline-block; width: 12ch;">Date</span>
                    <span style="display: inline-block; width: 18ch;">Journal</span>
                    <span style="display: inline-block; width: 8ch;">Lignes</span>
                    <span style="display: inline-block; width: 15ch; text-align: right;">Total Débit</span>
                    <span style="display: inline-block; width: 15ch; text-align: right;">Total Crédit</span>
                    <span style="display: inline-block; width: 30ch; text-align: center;">Actions</span>
                </div>
                <div class="table-content" id="batches-table-content" style="height: 300px; overflow-y: auto;">
                    <span class="no-data">(Chargement des lots...)</span>
                </div>
            </div>

            <div class="footer-container">
                <div class="status-bar"></div>
            </div>
        </div>
    </div>
</html> 